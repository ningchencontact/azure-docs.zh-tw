---
title: 關於服務網格
description: 取得服務網格的總覽、其架構和功能，以及您在選取要部署時應考慮的準則。
author: paulbouwer
ms.service: container-service
ms.topic: article
ms.date: 10/09/2019
ms.author: pabouwer
ms.openlocfilehash: 226a4e5cf97be2e23ef13a95b80be07b7fbf5d7a
ms.sourcegitcommit: f29fec8ec945921cc3a89a6e7086127cc1bc1759
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/17/2019
ms.locfileid: "72530702"
---
# <a name="about-service-meshes"></a>關於服務網格

服務網格提供工作負載的功能，例如流量管理、復原、原則、安全性、強身份識別和可檢視性。 您的應用程式會與這些作業功能分離，而服務網格會將其移出應用層，然後向下到基礎結構層。

## <a name="scenarios"></a>案例

當您使用服務網格時，可以針對您的工作負載啟用下列一些案例：

- 加密叢集中的**所有流量**-在叢集中指定的服務之間啟用相互 TLS。 這可以延伸到網路周邊的輸入和輸出。 提供安全的預設選項，且不需要變更應用程式程式碼和基礎結構。

- 未配置**和分階段**發行-指定要路由傳送至叢集內一組新服務的流量子集的條件。 成功測試有的刪除功能時，移除條件式路由和階段會逐漸增加所有流量到新服務的%。 最後，所有流量都會導向至新服務。

- **流量管理和操作**-在服務上建立原則，以限制從特定來源到某個服務版本的所有流量。 或將重試策略套用至指定服務之間失敗類別的原則。 在遷移期間，將即時流量鏡像至新版本的服務，或偵測到的問題。 在測試環境中的服務之間插入錯誤，以測試復原。

- **可檢視性**-深入瞭解服務如何連線到它們之間流動的流量。 取得叢集中所有流量的計量、記錄和追蹤，以及輸入/輸出。 將分散式追蹤功能新增至您的應用程式。

## <a name="architecture"></a>架構

服務網格通常是由控制平面和資料平面所組成。

**控制平面**有數個支援管理服務網格的元件。 這通常會包含可能是 UI 或 API 的管理介面。 通常也會有管理規則的元件，以及定義服務網格應如何執行特定功能的原則定義。 還有一些元件會管理安全性的層面，例如強式身分識別和適用于 mTLS 的憑證。 服務網格通常也會有計量或可檢視性元件，它會收集並匯總來自工作負載的計量和遙測。

**資料平面**通常包含以透明方式插入工作負載側車的 proxy。 此 proxy 設定為控制進出于包含工作負載之 pod 的所有網路流量。 這可讓 proxy 設定為透過 mTLS 保護流量、動態路由傳送流量、將原則套用至流量，以及收集計量和追蹤資訊。 

![一般服務網格架構](media/servicemesh/typical-architecture.png)

## <a name="capabilities"></a>容量

每個服務網格都有自然的配合，並著重于支援特定的案例，但您通常會發現，大部分的都是執行下列其中一項功能。

### <a name="traffic-management"></a>流量管理 

- **通訊協定**–第7層（HTTP、grpc）
- **動態路由**–條件式、加權、鏡像
- **復原**–超時、重試、斷路器
- **原則**-存取控制、速率限制、配額
- **測試**-錯誤插入

### <a name="security"></a>安全性

- **加密**-mTLS、憑證管理、外部 CA
- **強身份識別**– SPIFFE 或類似
- **Auth** –驗證、authorisation

### <a name="observability"></a>可檢視性

- **計量**–黃金計量，prometheus，grafana
- **追蹤**-工作負載之間的追蹤
- **流量**–叢集、輸入/輸出

### <a name="mesh"></a>網格

- **支援的計算**Kubernetes、虛擬機器
- **多**叢集-閘道、同盟

## <a name="selection-criteria"></a>選取準則

在您選取服務網格之前，請確定您瞭解您的需求，以及安裝服務網格的原因。 請嘗試詢問下列問題。

- **輸入控制器是否足以滿足我的需求？** -有時候在輸入時有一項功能（例如 a/b 測試或流量分割）就足以支援所需的案例。 請不要在您的環境中增加複雜度，而不會有任何優勢。

- **我的工作負載和環境可以容忍額外的負擔嗎？** -支援服務網格所需的所有其他元件都需要額外的資源，例如 cpu 和記憶體。 此外，所有 proxy 和其相關聯的原則都會檢查增加流量的延遲。 如果您的工作負載對延遲非常敏感，或無法提供其他資源來涵蓋服務網格元件，則請重新考慮。

- **這會不必要地增加額外的複雜性嗎？** -如果安裝服務網格的原因是要取得對商務或營運小組不一定重要的功能，請考慮安裝、維護和設定的額外複雜性是否值得使用。

- **這可以用累加方式採用嗎？** -提供許多功能的一些服務網格可以採用更累加的方式。 只安裝您所需的元件以確保成功。 當您更自信，而且需要額外的功能之後，請探索這些資訊。 避免從一開始就安裝*所有專案*。

如果在仔細考慮之後，您決定需要服務網格來提供所需的功能，那麼您的下一個決策是*哪個服務網格？*

請考慮下列各方面，其中哪一項最符合您的需求。 這會引導您最適合您的環境和工作負載。 [接下來的步驟](#next-steps)一節將引導您深入瞭解特定服務網格的詳細資訊，以及它們如何對應到這些區域。

- **技術**-流量管理、原則、安全性、可檢視性

- **商業**-商業支援、基礎（由 cncf）、OSS 授權、治理

- **營運**–安裝/升級，資源需求，效能需求，整合（計量，遙測，儀表板，工具，smi-s），混合工作負載（Linux 和 Windows 節點集區），計算（Kubernetes，虛擬機器），多叢集

- **安全性**驗證、身分識別、憑證管理和輪替、插即用外部 CA


## <a name="next-steps"></a>後續步驟

下列檔提供有關可在 Azure Kubernetes Service （AKS）上試用之服務網格的詳細資訊：

> [!div class="nextstepaction"]
> [深入瞭解 Istio .。。][istio-about]

> [!div class="nextstepaction"]
> [深入瞭解 Linkerd .。。][linkerd-about]

> [!div class="nextstepaction"]
> [深入瞭解 Consul .。。][consul-about]

您也可能想要探索服務網格介面（SMI-S），這是 Kubernetes 上服務網格的標準介面：

- [服務網狀介面（SMI-S）][smi]


<!-- LINKS - external -->
[smi]: https://smi-spec.io/

<!-- LINKS - internal -->
[istio-about]: ./servicemesh-istio-about.md
[linkerd-about]: ./servicemesh-linkerd-about.md
[consul-about]: ./servicemesh-consul-about.md