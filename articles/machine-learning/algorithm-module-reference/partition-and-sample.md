---
title: 資料分割和範例：模組參考
titleSuffix: Azure Machine Learning service
description: 瞭解如何在 Azure Machine Learning 服務中使用資料分割和範例模組，以在 dataset 上執行取樣，或從您的資料集建立磁碟分割。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 05/02/2019
ms.openlocfilehash: fcbf9fae3306c43613ef0b67a79c9c0b53f6b923
ms.sourcegitcommit: e0e6663a2d6672a9d916d64d14d63633934d2952
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/21/2019
ms.locfileid: "72693763"
---
# <a name="partition-and-sample-module"></a>資料分割和範例模組

本文描述適用于 Azure Machine Learning 服務的視覺化介面（預覽）模組。

使用此模組來執行資料集的取樣，或從您的資料集建立分割區。

取樣是機器學習中很重要的工具，因為它可讓您減少資料集的大小，同時維持相同的值比例。 此模組支援幾個在機器學習服務中很重要的相關工作： 

- 將您的資料分割成相同大小的多個子區段。 

    您可以使用資料分割進行交叉驗證，或將案例指派給隨機群組。

- 將資料分成群組，然後使用特定群組中的資料。 

    將案例隨機指派給不同的群組之後，您可能需要修改只與一個群組相關聯的功能。

- 抽樣. 

    您可以解壓縮資料的百分比、套用隨機取樣，或選擇要用來平衡資料集並對其值執行分層取樣的資料行。

- 建立較小的資料集進行測試。 

    如果您有大量資料，您可能只想在設定管線時使用前*n*個數據列，然後在建立模型時切換到使用完整資料集。 您也可以使用取樣來建立較小的資料集，以用於開發。

## <a name="configure-partition-and-sample"></a>設定資料分割和範例

此模組支援多種方法，可將您的資料分成多個分割或進行取樣。 先選擇方法，然後再設定方法所需的其他選項。

- Head
- 取樣
- 指派給折迭
- 挑選折迭

### <a name="get-top-n-rows-from-a-dataset"></a>從資料集取得前 N 個數據列

使用此模式只取得前*n*個數據列。 如果您想要在少數幾個資料列上測試管線，而不需要以任何方式平衡或取樣資料，這個選項就很有用。

1. 將**分割區和範例**模組加入至您在介面中的管線，並串連資料組。  

2. **分割或取樣模式**：將此選項設定為**Head**。

3. **要選取的資料列數目**：輸入要傳回的資料列數目。

    您指定的資料列數目必須為非負整數。 如果選取的資料列數目大於 dataset 中的資料列數目，則會傳回整個資料集。

4. 執行管道。

此模組會輸出單一資料集，其中只包含指定數目的資料列。 資料列一律會從資料集的頂端讀取。

### <a name="create-a-sample-of-data"></a>建立資料範例

此選項支援簡單的隨機取樣或階層式隨機取樣。 如果您想要建立較小的代表性範例資料集來進行測試，這會很有用。

1. 將**分割區和範例**模組新增至您的管線，並串連資料組。

2. **分割或取樣模式**：將此設定為 [**取樣**]。

3. **取樣率**：輸入介於0到1之間的值。 這個值會指定源資料集內應該包含在輸出資料集中的資料列百分比。

    例如，如果您只想要一半的原始資料集，請輸入 `0.5` 以指出取樣率應為50%。

    輸入資料集的資料列會隨機地放入輸出資料集，並根據指定的比例。

4. **取樣的隨機種子**：（選擇性）輸入要用來做為種子值的整數。

    如果您想要每次都以相同的方式來分割資料列，這個選項就很重要。 預設值為0，表示會根據系統時鐘產生起始種子。 這可能會在您每次執行管線時產生稍微不同的結果。

5. **分層分割以進行取樣**：如果必須在取樣之前，先以某個索引鍵資料行來平均分割 dataset 中的資料列，請選取此選項。

    針對 [**取樣的分層索引鍵資料行**]，選取要在分割資料集時使用的單一分層資料*行*。 然後，資料集中的資料列會分割如下：

    1. 所有輸入資料列都是依指定分層資料行中的值分組（分層）。

    2. 資料列在每個群組內是隨機的。

    3. 每個群組會選擇性地加入至輸出資料集，以符合指定的比率。


6. 執行管道。

    使用此選項時，此模組會輸出單一資料集，其中包含資料的代表性取樣。 資料集的剩餘、unsampled 部分不是輸出。 

## <a name="split-data-into-partitions"></a>將資料分割成磁碟分割

當您想要將資料集分割成資料的子集時，請使用此選項。 當您想要建立自訂的交叉驗證折迭數目，或將資料列分割成數個群組時，這個選項也很有用。

1. 將**分割區和範例**模組新增至您的管線，並串連資料組。

2. 針對 [資料**分割] 或 [取樣模式]** ，選取 [**指派給**折迭]。

3. 在資料**分割中使用取代**：如果您想要將取樣資料列放回資料列集區，以供潛在重複使用，請選取此選項。 因此，相同的資料列可能會被指派給數個折迭。

    如果您不使用取代（預設選項），則取樣的資料列不會放回資料列集區中，以供潛在重複使用。 因此，每個資料列只能指派給一個折迭。

4. **隨機分割**：如果您想要將資料列隨機指派給折迭，請選取此選項。

    如果您未選取此選項，則會使用迴圈配置資源方法，將資料列指派給折迭。

5. **隨機種子**：選擇性地輸入要用來做為種子值的整數。 如果您想要每次都以相同的方式來分割資料列，這個選項就很重要。 否則，預設值為0，表示將會使用隨機起始種子。

6. **指定**分割區方法：使用下列選項，指出您要如何將資料分配到每個分割區：

    - **平均分割**：使用此選項可在每個分割區中放置相等數目的資料列。 若要指定輸出分割區的數目，請在 [指定折迭**數**] 方塊中輸入整數。

    - **具有自訂比例的磁碟分割**：使用此選項可將每個分割區的大小指定為逗號分隔清單。

        例如，如果您想要建立三個分割區，其中第一個資料分割包含50% 的資料，而剩餘的兩個數據分割各包含25% 的資料，請按一下 [以**逗號分隔的比例清單**]，然後輸入下列數位： `.5, .25, .25`

        所有資料分割大小的總和都必須剛好加上1。

        - 如果您輸入的數位會加上**小於 1**，則會建立額外的分割區來保存其餘的資料列。 例如，如果您輸入 .2 和 .3 值，則會建立第三個分割區，以保存所有資料列的剩餘 50%。

        - 如果您輸入的數位加上最**多1個**，則當您執行管線時，就會引發錯誤。

7. **分層分割**：如果您想要在分割時分層資料列，然後選擇 [_分層_] 資料行，請選取此選項。

8. 執行管道。

    使用此選項時，此模組會輸出多個資料集，並使用您指定的規則進行分割。

### <a name="use-data-from-a-predefined-partition"></a>使用預先定義之分割區中的資料  

當您將資料集分成多個分割區，而現在想要依序載入每個分割區以進行進一步分析或處理時，會使用此選項。

1. 將資料**分割和範例**模組新增至管線。

2. 將它連接到先前的資料**分割和範例**實例的輸出。 該實例必須使用 [**指派給**折迭] 選項來產生一些資料分割。

3. **分割或取樣模式**：選取 [**挑選折**迭]。

4. **指定要取樣的折**迭：選取要使用的資料分割，方法是輸入其索引。 資料分割索引是以1為基礎。 例如，如果您將資料集分成三個部分，則分割區會有索引1、2和3。

    如果您輸入不正確索引值，則會引發設計階段錯誤：「錯誤0018：資料集包含不正確資料。」

    除了藉由折迭分組資料集之外，您還可以將資料集分成兩個群組：目標折迭，以及其他所有專案。 若要這麼做，請輸入單一折迭的索引，然後選取選項 [**挑選所選折迭的補數**]，以取得指定之折迭中的所有專案，但不包括資料。

5. 如果您要使用多個資料分割，則必須加入資料分割的其他實例**和範例**模組來處理每個資料分割。

    例如，假設先前將患者分割成使用年齡的四個折迭。 若要使用每個個別的折迭，您需要資料**分割和範例**模組的四個複本，而在每個中，您會選取不同的折迭，如下所示。 使用 [**指派**] 直接折迭輸出並不正確。  

    [![Partition 和範例](./media/partition-and-sample/partition-and-sample.png)](./media/partition-and-sample/partition-and-sample-lg.png#lightbox)

5. 執行管道。

    使用此選項時，此模組會輸出單一資料集，其中只包含指派給該折迭的資料列。

> [!NOTE]
>  您無法直接查看折迭的稱號;它們只會出現在中繼資料中。

## <a name="next-steps"></a>後續步驟

請參閱可用來 Azure Machine Learning 服務的[模組集合](module-reference.md)。 