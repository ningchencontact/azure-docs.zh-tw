---
title: 設定管理員同意工作流程-Azure Active Directory |Microsoft Docs
description: 瞭解如何設定一種方法，讓終端使用者要求存取需要系統管理員同意的應用程式。
services: active-directory
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.topic: conceptual
ms.date: 10/29/2019
ms.author: mimart
ms.reviewer: luleon
ms.collection: M365-identity-device-management
ms.openlocfilehash: b5d1654556df455accb7f615442d3a97952c5e50
ms.sourcegitcommit: 98ce5583e376943aaa9773bf8efe0b324a55e58c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/30/2019
ms.locfileid: "73180416"
---
# <a name="configure-the-admin-consent-workflow-preview"></a>設定系統管理員同意工作流程（預覽）

本文說明如何啟用系統管理員同意工作流程（預覽）功能，讓終端使用者能夠要求存取需要系統管理員同意的應用程式。

若沒有系統管理員同意工作流程，當使用者嘗試存取任何需要存取組織資料許可權的應用程式時，將會封鎖已停用使用者同意的租使用者中使用者。 使用者會看到一般錯誤訊息，指出他們未獲授權可存取應用程式，而且他們應該詢問系統管理員以取得協助。 但是，使用者通常不知道誰可以聯絡，所以他們會在應用程式中放棄或建立新的本機帳戶。 即使系統管理員收到通知，也不一定會有簡化的程式，協助系統管理員授與存取權並通知使用者。
 
系統管理員同意工作流程可讓系統管理員以安全的方式，授與需要系統管理員核准的應用程式存取權。 當使用者嘗試存取應用程式但無法提供同意時，他們可以傳送要求以進行系統管理員核准。 要求是透過電子郵件傳送給已指定為審核者的系統管理員。 審核者會對要求採取動作，而使用者會收到動作的通知。

若要核准要求，審核者必須是全域管理員、雲端應用程式系統管理員或應用程式系統管理員。 審查者必須已指派其中一個系統管理員角色;只是將它們指定為審核者並不會提升其許可權。

## <a name="enable-the-admin-consent-workflow"></a>啟用管理員同意工作流程

若要啟用系統管理員同意工作流程並選擇 [審核者]：

1. 以全域管理員身分登入 [Azure 入口網站](https://portal.azure.com) 。
2. 按一下左側導覽功能表頂端的 [ **所有服務**] 。  **Azure Active Directory 延伸**模組 隨即開啟。
3. 在 篩選搜尋 方塊中，輸入 "**Azure Active Directory**"，然後選取**Azure Active Directory** 專案。
4. 從導覽功能表中，按一下 [ **企業應用程式**]。 
5. 在 [**管理**] 底下，選取 [**使用者設定**]。
6. 在 **[系統管理員同意要求（預覽）** ] 底下，設定 [**使用者可以要求系統管理員同意他們無法同意的應用程式** **]** 。

   ![設定系統管理員同意工作流程設定](media/configure-admin-consent-workflow/admin-consent-requests-settings.png)
 
6. 設定下列設定：

   * **選取 [使用者] 以審查管理員同意要求**。 從具有全域管理員、雲端應用程式系統管理員和應用程式系統管理員角色的一組使用者，選取此工作流程的 [審核者]。
   * **選取的使用者將會收到要求的電子郵件通知**。 當提出要求時，啟用或停用電子郵件通知給審核者。  
   * **選取的使用者將會收到要求到期提醒**。 當要求即將到期時，啟用或停用提醒電子郵件通知給審核者。  
   * **同意要求會在（天）後到期**。 指定要求保持有效的時間長度。

7. 選取 [儲存]。 此功能最多可能需要一小時的時間才會啟用。

> [!NOTE]
> 您可以藉由修改 [**選取管理員同意要求審核者**] 清單來新增或移除此工作流程的審核者。 請注意，這項功能目前的限制是，審核者可以保留在被指定為審核者時，檢查要求的功能。

## <a name="how-users-request-admin-consent"></a>使用者要求系統管理員同意的方式

啟用系統管理員同意工作流程之後，使用者就可以針對未經授權同意的應用程式要求管理員核准。 下列步驟說明使用者在要求核准時的體驗。 

1. 使用者嘗試登入應用程式。

2. [**需要核准**] 訊息隨即出現。 使用者可以輸入需要存取應用程式的理由，然後選取 [**要求核准**]。

   ![管理員同意使用者要求和理由](media/configure-admin-consent-workflow/end-user-justification.png)

3. [**要求已傳送**] 訊息會確認要求已提交給系統管理員。如果使用者傳送數個要求，則只有第一個要求會提交給系統管理員。

   ![管理員同意使用者要求和理由](media/configure-admin-consent-workflow/end-user-sent-request.png)

 4. 當使用者的要求獲得核准、拒絕或封鎖時，會收到電子郵件通知。 

## <a name="review-and-take-action-on-admin-consent-requests"></a>審查並對系統管理員同意要求採取行動

若要檢查系統管理員同意要求並採取行動：

1. 以系統管理員同意工作流程的其中一個已註冊的審核者身分登入 [Azure 入口網站](https://portal.azure.com) 。
2. 選取左側導覽功能表頂端的 [**所有服務**] 。  **Azure Active Directory 延伸**模組 隨即開啟。
3. 在 篩選搜尋 方塊中，輸入 "**Azure Active Directory**"，然後選取  **Azure Active Directory** 專案。
4. 從導覽功能表中，按一下 [ **企業應用程式**]。
5. 在 [**活動**] 下，選取 **[管理員同意要求（預覽）** ]。

   > [!NOTE]
   > 審核者只會看到在被指定為審核者之後所建立的系統管理要求。

1. 選取所要求的應用程式。
2. 查看要求的詳細資料：  

   * 若要查看正在要求存取的人員和原因，請選取 [**要求者**] 索引標籤。
   * 若要查看應用程式所要求的許可權，請選取 [**審查許可權和同意**]。

8. 評估要求並採取適當的動作：

   * **核准要求**。 若要核准要求，請將系統管理員同意授與應用程式。 一旦要求獲得核准，所有要求者都會收到通知，指出已授與存取權。  
   * **拒絕要求**。 若要拒絕要求，您必須提供將提供給所有要求者的理由。 一旦要求遭到拒絕，所有要求者都會收到通知，指出它們已被拒絕存取應用程式。 拒絕要求並不會防止使用者在未來再次向應用程式要求系統管理員同意。  
   * **封鎖要求**。 若要封鎖要求，您必須提供將提供給所有要求者的理由。 一旦要求遭到封鎖，所有要求者都會收到拒絕存取應用程式的通知。 封鎖要求會為租使用者中的應用程式建立服務主體物件（處於已停用狀態）。 使用者未來將無法向應用程式要求系統管理員同意。
 
## <a name="email-notifications"></a>電子郵件通知
 
若已設定，所有審核者都會在下列情況收到電子郵件通知：

* 已建立新的要求
* 要求已過期
* 要求已接近到期日  
 
當下列情況發生時，要求者會收到電子郵件通知：

* 他們會提交新的存取要求
* 其要求已過期
* 已拒絕或封鎖其要求
* 已核准其要求
 
## <a name="audit-logs"></a>稽核記錄 
 
下表列出系統管理員同意工作流程可用的案例和 audit 值。 

> [!NOTE]
> 在所有案例中，目前都缺少 audit 動作專案的使用者內容。 這是預覽版本中的已知限制。


|案例  |Audit 服務  |稽核類別  |Audit 活動  |Audit 執行者  |Audit 記錄檔限制  |
|---------|---------|---------|---------|---------|---------|
|管理員啟用同意要求工作流程        |存取權審核           |Usermanagement program.cs           |建立治理原則範本          |應用程式內容            |目前找不到使用者內容            |
|管理員停用同意要求工作流程       |存取權審核           |Usermanagement program.cs           |刪除治理原則範本          |應用程式內容            |目前找不到使用者內容           |
|管理員更新同意工作流程設定        |存取權審核           |Usermanagement program.cs           |更新治理原則範本          |應用程式內容            |目前找不到使用者內容           |
|終端使用者建立應用程式的管理員同意要求       |存取權審核           |原則         |建立要求           |應用程式內容            |目前找不到使用者內容           |
|核准系統管理員同意要求的審核者       |存取權審核           |Usermanagement program.cs           |核准商務流程中的所有要求          |應用程式內容            |您目前找不到已授與系統管理員同意的使用者內容或應用程式識別碼。           |
|拒絕管理員同意要求的審核者       |存取權審核           |Usermanagement program.cs           |核准商務流程中的所有要求          |應用程式內容            | 目前您找不到拒絕系統管理員同意要求之動作專案的使用者內容          |

## <a name="faq"></a>常見問題集 

**我已開啟此工作流程，但在測試功能時，為什麼我無法看到新的「需要核准」提示，讓我要求存取權？**

開啟功能之後，最多可能需要60分鐘的時間，使用者才會看到更新。 您可以藉由在 `https://graph.microsoft.com/beta/settings` API 中查看**EnableAdminConsentRequests**值，確認設定已正確地生效。

**身為審核者，為什麼看不到所有擱置中的要求？**

審核者只能看到在被指定為審核者之後所建立的系統管理要求。 因此，如果您最近新增為審核者，您將不會看到指派之前所建立的任何要求。

**身為審核者，為什麼我會看到相同應用程式的多個要求？**
  
如果應用程式開發人員已設定其應用程式使用靜態和動態同意來要求存取其使用者的資料，您會看到兩個系統管理員同意要求。 其中一個要求代表靜態許可權，另一個則代表動態許可權。

**身為要求者，我可以檢查要求的狀態嗎？**  

否，現在要求者只能夠透過電子郵件通知取得更新。

**身為審核者，是否可以核准應用程式，而不是針對所有人？**
 
如果您擔心授與系統管理員同意，並允許租使用者中的所有使用者使用應用程式，我們建議您拒絕要求。 然後，藉由要求使用者指派並將使用者或群組指派給應用程式，以手動方式授與系統管理員同意。 如需詳細資訊，請參閱[指派使用者和群組的方法](methods-for-assigning-users-and-groups.md)。

## <a name="next-steps"></a>後續步驟

如需同意應用程式的詳細資訊，請參閱 [Azure Active Directory 同意架構](../develop/consent-framework.md)。

[同意並將應用程式整合到 AzureAD](../develop/quickstart-v1-integrate-apps-with-azure-ad.md)

[適用於 AzureAD v2.0 交集應用程式的同意與權限](../develop/active-directory-v2-scopes.md)

[AzureAD StackOverflow (英文)](https://stackoverflow.com/questions/tagged/azure-active-directory)
