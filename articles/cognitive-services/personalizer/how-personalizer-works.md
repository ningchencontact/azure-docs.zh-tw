---
title: 個人化工具的運作方式 - 個人化工具
titleSuffix: Azure Cognitive Services
description: 個人化工具會使用機器學習來探索要在內容中使用的動作。 每個學習迴圈都會有一個模型，這個模型會專門根據您透過排名和報酬呼叫而傳送給模型的資料來進行定型。 每個學習迴圈彼此完全無關。
author: diberry
manager: nitinme
ms.service: cognitive-services
ms.subservice: personalizer
ms.topic: conceptual
ms.date: 06/07/2019
ms.author: diberry
ms.openlocfilehash: e55ccb508760c4473f71245c183948219f31985c
ms.sourcegitcommit: e3b0fb00b27e6d2696acf0b73c6ba05b74efcd85
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/30/2019
ms.locfileid: "68663921"
---
# <a name="how-personalizer-works"></a>個人化工具的運作方式

個人化工具會使用機器學習來探索要在內容中使用的動作。 每個學習迴圈都會有一個模型，這個模型會專門根據您透過**排名**和**報酬**呼叫而傳送給模型的資料來進行定型。 每個學習迴圈彼此完全無關。 請針對您想要個人化的應用程式，為其每個組件或行為建立學習迴圈。

針對每個迴圈，請根據目前的內容，使用下列清單來**呼叫排名 API**：

* 可能動作清單：可從中選取最佳動作的內容項目。
* [內容特性](concepts-features.md)清單：與情境相關的資料，例如使用者、內容和情境。

**排名** API 會決定使用：

* 利用  ：目前的模型，其會根據過去的資料來決定最佳的動作。
* 探索  ：選取不同的動作，而非最佳動作。

**報酬** API：

* 會收集資料，藉由記錄每個排名呼叫的特性和報酬分數來將模型定型。
* 會使用該資料，根據「學習原則」  中指定的設定來更新模型。

## <a name="architecture"></a>架構

下圖顯示排名和報酬呼叫的呼叫架構流程：

![替代文字](./media/how-personalizer-works/personalization-how-it-works.png "個人化的運作方式")

1. 個人化工具使用內部 AI 模型來判斷動作的排名。
1. 服務決定是要利用目前的模型，還是探索新的模型選項。  
1. 排名結果傳送至事件中樞。
1. 當個人化工具收到報酬時，報酬會傳送至事件中樞。 
1. 排名和報酬會相互關聯。
1. AI 模型會根據相互關聯結果來加以更新。
1. 推斷引擎會更新為新的模型。 

## <a name="research-behind-personalizer"></a>個人化工具背後的研究

個人化工具的依據是[增強式學習](concepts-reinforcement-learning.md)領域的尖端科學和研究，包括論文、研究活動和 Microsoft Research 中正在進行的探索領域。

## <a name="terminology"></a>術語

* **學習迴圈**：您可以針對會受益於個人化的應用程式，為其各個組件建立學習迴圈。 如果您有多個要個人化的經驗，請為每個經驗各建立一個迴圈。 

* **動作**：動作是可從中選擇的內容項目，例如產品或促銷活動。 個人化工具會透過排名 API 選擇最佳動作來對使用者顯示，此動作也稱為「報酬動作」  。 每個動作都可以有使用排名要求所提交的特性。

* **Context**：若要提供更精確的排名，請提供內容的相關資訊，例如：
    * 您的使用者。
    * 其所使用的裝置。 
    * 目前的時間。
    * 其他關於目前情況的資料。
    * 關於使用者或內容的歷史資料。

    特定應用程式可能會有不同的內容資訊。 

* **[特性](concepts-features.md)** ：內容項目或使用者內容的相關資訊單位。

* **報酬**：可測量使用者與排名 API 所傳回動作的對應程度，以 0 到 1 之間的分數來表示。 0 到 1 的值是由商務邏輯根據所做選擇對協助達成個人化商務目標有多大幫助而做出設定。 

* **探索**：個人化工具服務在為使用者選擇不同動作時會進行探索，而不是傳回最佳動作。 個人化工具服務可避開變化、停滯，並可藉由探索來適應不斷發展的使用者行為。 

* **實驗持續時間**：個人化工具服務等候報酬的時間量，從該事件發生排名呼叫的當下起算。

* **非作用中事件**：當您呼叫排名，但不確定使用者是否會看到結果 (因為用戶端應用程式的決定) 時，便是非作用中事件。 非作用中事件可讓您建立並儲存個人化結果，並在不會影響機器學習模型的情況下，於之後決定捨棄這些結果。

* **模型**：個人化工具模型會擷取所有已學習到的使用者行為相關資料，結合您傳送給排名和報酬呼叫的引數以及學習原則所決定的定型行為，來取得定型資料。 

* **學習原則**:個人化工具如何在每個事件上定型模型, 會由一些會影響機器學習服務演算法如何工作的中繼參數來決定。 新的個人化工具迴圈將從預設學習原則開始, 這可能會產生中等效能。 執行[評估](concepts-offline-evaluation.md)時, 個人化工具可以建立特別針對您的迴圈使用案例優化的新學習原則。 針對每個特定迴圈 (在評估期間所產生) 優化的原則, 個人化工具的執行效果大幅提升。

## <a name="example-use-cases-for-personalizer"></a>個人化工具的範例使用案例

* 意圖釐清與去除混淆：藉由提供給每個使用者個人化選項，協助您的使用者在意圖不明確時，獲得更好的體驗。
* 功能表與選項的預設建議：第一步改為讓 Bot 以個人化方式提供最相關的項目，而不是呈現非個人化個功能表或替代項目清單。
* Bot 特徵與語氣：對於可具有不同語氣、贅詞和撰寫風格的 Bot，請考慮依個人化方式改變這些特徵。
* 通知與警示內容：決定要用於通知的文字，讓通知更能與使用者互動。
* 通知與警示時機：已針對何時傳送通知給使用者可獲得更多互動，來進行個人化學習。

## <a name="checklist-for-applying-personalizer"></a>套用個人化工具的檢查清單

您可以在下列情況中套用個人化工具：

* 您期望應用程式能達成商務或可用性目標。
* 應用程式中有某個地方若能根據內容來決定要對使用者顯示的項目，將可改善該目標。
* 從使用者的整體行為和總報酬分數，將能學習到最佳選擇，且應該這麼做。
* 在為了個人化而使用機器學習時，有遵循[負責任的使用指導方針](ethics-responsible-use.md)和您小組選擇的選項。
* 決策可表示成對有限選項集合進行最佳選項 ([動作](concepts-features.md#actions-represent-a-list-of-options)) 排名。
* 該選擇的效果如何可由您的商務邏輯來計算，透過測量使用者行為的某些層面，並以介於 -1 和 1 之間的數字表示。
* 獎勵分數不會帶來太多混淆或外部因素，更明確地說，實驗持續時間夠短，足以計算獎勵分數但仍然相關。
* 您可以將排名的內容表示為至少有 5 個特徵的字典，這些特性是您認為有助於做出正確選擇，且不包含個人識別資訊的特徵。
* 您擁有每個動作的相關資訊，其形式為含有至少 5 個屬性或特徵的字典，它們是您認為有助於個人化工具做出正確選擇的屬性或特徵。
* 您可以長時間保留資料，而足以累積至少 100,000 個互動的歷程記錄。

## <a name="machine-learning-considerations-for-applying-personalizer"></a>適用於套用個人化工具的機器學習考量

個人化工具是以增強式學習作為基礎，這是一種藉由您提供的意見反應來接受教導的機器學習方法。 

在下列情況時，個人化工具會有最佳學習效果：
* 即使問題會隨時間而變化 (例如，對於新聞或流行的偏好)，仍有足夠事件可以掌握最佳個人化。 個人化工具會適應真實世界的持續變化，但如果沒有足夠的事件和資料可供學習以便探索並確定新的模式，就無法獲得最佳結果。 請選擇發生頻率夠高的使用案例。 在尋找時，請考慮每天至少發生 500 次的使用案例。
* 內容和動作有足夠的特徵能夠促進學習。
* 每次呼叫時，所要排名的動作少於 50 個。
* 資料保留設定可讓個人化工具收集足夠的資料來執行離線評估和原則最佳化。 一般來說，至少要有 50,000 個資料點。

## <a name="how-to-use-personalizer-in-a-web-application"></a>如何在 Web 應用程式中使用個人化工具

將迴圈加入至 Web 應用程式包括：

* 決定要個人化的體驗、您擁有什麼動作和特徵、要使用什麼內容特徵，以及要設定什麼獎勵。
* 在您的應用程式中加入個人化 SDK 的參考。
* 當您準備好要個人化時，請呼叫排名 API。
* 儲存 eventId。 您稍後使用獎勵 API 傳送獎勵。
1. 當您確定使用者看過個人化頁面之後，呼叫事件的啟動。
1. 等候使用者選取排名內容。 
1. 呼叫獎勵 API，以指定排名 API 的輸出效果如何。

## <a name="how-to-use-personalizer-with-a-chat-bot"></a>如何搭配使用個人化工具與聊天機器人

在此範例中，您會看到如何使用個人化提供預設建議，而不是每次都提供使用者一系列功能表或選擇。

* 取得此範例的[程式碼](https://github.com/Azure-Samples/cognitive-services-personalizer-samples/tree/master/samples/ChatbotExample)。
* 設定您的 Bot 解決方案。 請務必發佈您的 LUIS 應用程式。 
* 管理 Bot 的排名和獎勵 API 呼叫。
    * 新增管理 LUIS 意圖處理的程式碼。 如果傳回排名最高的意圖是 **None**，或排名最高意圖的分數低於您的商務邏輯閾值，請將意圖清單傳送至個人化工具來為意圖排名。
    * 將意圖清單向使用者顯示為可選取的連結，其中第一個意圖是排名 API 所回應排名最高的意圖。
    * 擷取使用者的選取項目，並在獎勵 API 呼叫中傳送此項目。 

### <a name="recommended-bot-patterns"></a>建議的 Bot 模式

* 每當需要去除混淆時，呼叫個人化工具排名 API，而不是快取每個使用者的結果。 一個人的去除混淆意圖結果可能會隨時間改變，這讓排名 API 能探索加速整體學習的差異。
* 選擇許多使用者都通用的互動，這樣您就有足夠的資料進行個人化。 例如，簡介式的問題可能比對話圖形中深處只有少數使用者前往的小範圍釐清更適合。
* 使用排名 API 呼叫來啟用「第一個建議是正確的」對話，系統會問使用者「您是否要 X？」 或「您的意思是 X？」 而使用者可以直接確認；而不是提供使用者必須從菜單選擇的選項。 例如，使用者：「我要點咖啡」，Bot：「您要雙份濃縮咖啡嗎？」。 如此一來，獎勵訊號也會很強，因為它維持直接針對一個建議。

## <a name="how-to-use-personalizer-with-a-recommendation-solution"></a>如何搭配使用個人化工具與建議解決方案

使用您的建議引擎將大型目錄篩選為少數項目，接著可表示為 30 個可能的動作，傳送至排名 API。

您可以搭配使用建議引擎與個人化工具：

* 設定[建議方案](https://github.com/Microsoft/Recommenders/) \(英文\)。 
* 當頁面顯示時，叫用建議模型，以取得建議的簡短清單。
* 呼叫個人化來為建議解決方案的輸出排名。
* 使用獎勵 API 呼叫來傳送關於您使用者動作的意見反應。


## <a name="pitfalls-to-avoid"></a>要避免的陷阱

* 如果個人化行為不是能在所有使用者之間探索的項目，則請勿使用個人化工具，而應該用於要針對特定使用者記憶的項目，或來自使用者特定替代項目清單的項目。 例如，使用個人化工具從 20 個可能的菜單項目中，建議第一個披薩訂單會很有用，但若需要從使用者的連絡人清單中，建議幫忙照顧小孩應該要打電話給誰 (例如「奶奶」) 時，這不是能夠在您的整個使用者群中個人化的項目。


## <a name="adding-content-safeguards-to-your-application"></a>將內容保護功能新增至您的應用程式

如果您的應用程式允許向使用者顯示的內容包含各種類型，而某些內容可能對某些使用者來說不安全或不適當，則您應該事先規劃，確保有內容保護功能可防止使用者看到不適當的內容。 實作保護功能的最佳模式是：實作保護功能的最佳模式是：
    * 取得要排名的動作清單。
    * 篩選掉不適用於該對象的項目。
    * 只為這些適用的動作排名。
    * 向使用者顯示排名最高的動作。

在某些架構中，可能難以按照上述順序實作。 在此情況下，有替代方法可在排名之後實作保護功能，但必須佈建，才能使落在保護功能外的動作不會用於訓練個人化工具模型。

* 取得要排名的動作清單，並且停用學習。
* 排名動作。
* 檢查排名最高的動作是否適用。
    * 如果排名最高的動作適用，則啟動此排名的學習，然後向使用者顯示排名。
    * 如果排名最高的動作不適用，則不啟動此排名的學習，並透過您自己的邏輯或替代方法來決定向使用者顯示的項目。 即使您使用排名第二高的選項，也不要啟動此排名的學習。

## <a name="verifying-adequate-effectiveness-of-personalizer"></a>確認個人化工具的適當效果

您可以藉由執行[離線評估](how-to-offline-evaluation.md)，定期地監視個人化工具的效果

## <a name="next-steps"></a>後續步驟

了解[您可以在哪些地方使用個人化工具](where-can-you-use-personalizer.md)。
執行[離線評估](how-to-offline-evaluation.md)
